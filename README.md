# çŸ¥å¾®å¤šæ¨¡æ€Agentç”µå•†å®¢æœä¸­å°

**ZhiWei Multimodal Agent E-commerce Customer Service Platform**

åŸºäº RAG (Retrieval-Augmented Generation) çš„æ™ºèƒ½å®¢æœç³»ç»Ÿï¼Œæ”¯æŒå¤šè½®å¯¹è¯ã€æ„å›¾è¯†åˆ«ã€çŸ¥è¯†åº“æ£€ç´¢ã€å·¥å…·è°ƒç”¨å’Œå¤šæ¨¡æ€äº¤äº’ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- ğŸ¤– **å¤šè½®å¯¹è¯**ï¼šåŸºäº Redis çš„ä¼šè¯ç®¡ç†ï¼Œæ”¯æŒä¸Šä¸‹æ–‡ç†è§£
- ğŸ” **æ··åˆæ£€ç´¢**ï¼šå‘é‡æ£€ç´¢ (ChromaDB) + å…³é”®è¯æ£€ç´¢ (Elasticsearch) + RRF èåˆ
- ğŸ› ï¸ **å·¥å…·è°ƒç”¨**ï¼šè®¢å•æŸ¥è¯¢ã€ç‰©æµè¿½è¸ªã€åº“å­˜æŸ¥è¯¢ã€é€€æ¬¾ç”³è¯·ç­‰ä¸šåŠ¡æŠ€èƒ½
- ğŸ“„ **æ–‡æ¡£å¤„ç†**ï¼šæ”¯æŒ PDF/TXT æ–‡ä»¶ä¸Šä¼ å’Œ OCR è¯†åˆ«
- ğŸ–¼ï¸ **å¤šæ¨¡æ€**ï¼šæ”¯æŒå›¾ç‰‡ç†è§£å’Œå¤„ç†
- ğŸ“Š **è¯„æµ‹ç³»ç»Ÿ**ï¼šLLM-as-a-Judge è‡ªåŠ¨åŒ–è¯„æµ‹

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å‰ç«¯ç•Œé¢                            â”‚
â”‚                  (HTML + Tailwind CSS)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FastAPI æœåŠ¡å±‚                        â”‚
â”‚         (main.py - è·¯ç”±ã€æµå¼å“åº”ã€æ–‡ä»¶ä¸Šä¼ )              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   å¯¹è¯ç®¡ç†å™¨ (dialog.py)                 â”‚
â”‚              æ„å›¾è¯†åˆ« â†’ Agentè°ƒç”¨ â†’ RAGæ£€ç´¢              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚             â”‚                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LLM Agent    â”‚ â”‚  RAG ç®¡é“  â”‚ â”‚   å·¥å…·/æŠ€èƒ½    â”‚
â”‚  (agent.py)   â”‚ â”‚  (rag.py)  â”‚ â”‚  (skills.py)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æ•°æ®å±‚                              â”‚
â”‚  ChromaDB(å‘é‡) â”‚ Elasticsearch(å…³é”®è¯) â”‚ MySQL(ä¸šåŠ¡)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

| ç»„ä»¶ | æŠ€æœ¯ |
|------|------|
| åç«¯æ¡†æ¶ | FastAPI |
| å‘é‡æ•°æ®åº“ | ChromaDB |
| æœç´¢å¼•æ“ | Elasticsearch |
| ç¼“å­˜ | Redis |
| å…³ç³»æ•°æ®åº“ | MySQL |
| LLM | Gemini API (å¯æ›¿æ¢) |
| Embedding | é˜¿é‡Œäº‘ DashScope |
| é‡æ’åº | BGE-Reranker (æœ¬åœ°) |
| å®¹å™¨åŒ– | Docker Compose |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å…‹éš†é¡¹ç›®
```bash
git clone https://github.com/SR88888888/zhiwei-multimodal-agent.git
cd zhiwei-multimodal-agent
```

### 2. é…ç½®ç¯å¢ƒå˜é‡
```bash
cp .env.example .env
# ç¼–è¾‘ .env å¡«å…¥æ‚¨çš„ API å¯†é’¥
```

### 3. å¯åŠ¨æœåŠ¡
```bash
docker-compose up -d
```

### 4. å¯¼å…¥çŸ¥è¯†åº“
```bash
docker exec -it rag-app python import_kb.py
```

### 5. è®¿é—®æœåŠ¡
- ğŸ’¬ èŠå¤©ç•Œé¢: http://localhost:8000
- ğŸ“Š ç®¡ç†åå°: http://localhost:8000/admin
- ğŸ“– API æ–‡æ¡£: http://localhost:8000/docs

## ğŸ“ é¡¹ç›®ç»“æ„
```
â”œâ”€â”€ main.py              # FastAPI ä¸»å…¥å£
â”œâ”€â”€ agent.py             # LangChain Agent å®ç°
â”œâ”€â”€ rag.py               # RAG æ£€ç´¢ç®¡é“ï¼ˆRRF + Rerankï¼‰
â”œâ”€â”€ skills.py            # ä¸šåŠ¡æŠ€èƒ½/å·¥å…·å®šä¹‰
â”œâ”€â”€ dialog.py            # å¯¹è¯ç®¡ç†å™¨
â”œâ”€â”€ vectorstore.py       # å‘é‡å­˜å‚¨å°è£… (ChromaDB)
â”œâ”€â”€ es_client.py         # Elasticsearch å®¢æˆ·ç«¯
â”œâ”€â”€ llms.py              # LLM/Embedding/Reranker å°è£…
â”œâ”€â”€ memory.py            # å¤šè½®å¯¹è¯è®°å¿† (Redis)
â”œâ”€â”€ intent.py            # æ„å›¾è¯†åˆ«
â”œâ”€â”€ evaluation.py        # è¯„æµ‹æ¨¡å—
â”œâ”€â”€ ocr_processor.py     # PDF/å›¾ç‰‡å¤„ç†
â”œâ”€â”€ frontend/            # å‰ç«¯é¡µé¢
â”‚   â”œâ”€â”€ index.html       # èŠå¤©ç•Œé¢
â”‚   â””â”€â”€ admin.html       # ç®¡ç†åå°
â”œâ”€â”€ test_data/           # æµ‹è¯•æ•°æ®
â”‚   â”œâ”€â”€ knowledge_base.json
â”‚   â””â”€â”€ eval_cases.json
â”œâ”€â”€ docker-compose.yml   # Docker ç¼–æ’
â”œâ”€â”€ Dockerfile           # å®¹å™¨æ„å»º
â”œâ”€â”€ requirements.txt     # Python ä¾èµ–
â”œâ”€â”€ init.sql             # æ•°æ®åº“åˆå§‹åŒ–
â””â”€â”€ init_data.sql        # æµ‹è¯•æ•°æ®
```

## ğŸ“Š è¯„æµ‹ç»“æœ

| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| æ„å›¾å‡†ç¡®ç‡ | 97.5% |
| æ£€ç´¢å¬å›ç‡ | 87% |
| ç”Ÿæˆç›¸å…³æ€§ | 89.50 (LLMè¯„åˆ†) |
| å¹³å‡å»¶è¿Ÿ | 3.01s |

## ğŸ”§ æ ¸å¿ƒæ¨¡å—è¯´æ˜

### RAG æ£€ç´¢ç®¡é“
- **å¤šè·¯å¬å›**ï¼šå‘é‡æ£€ç´¢ + ES å…³é”®è¯æ£€ç´¢å¹¶è¡Œæ‰§è¡Œ
- **ç²—æ’**ï¼šRRF (Reciprocal Rank Fusion) èåˆæ’åº
- **ç²¾æ’**ï¼šBGE-Reranker æœ¬åœ°æ¨¡å‹é‡æ’åº

### Agent å·¥å…·
| å·¥å…·å | åŠŸèƒ½ |
|--------|------|
| query_order | è®¢å•æŸ¥è¯¢ |
| cancel_order | å–æ¶ˆè®¢å• |
| apply_refund | ç”³è¯·é€€æ¬¾ |
| query_logistics | ç‰©æµæŸ¥è¯¢ |
| check_stock | åº“å­˜æŸ¥è¯¢ |
| compare_products | å•†å“å¯¹æ¯” |
| search_knowledge | çŸ¥è¯†åº“æ£€ç´¢ |

## ğŸ“¥ çŸ¥è¯†åº“æ–‡ä»¶

å¤§å‹ PDF æ–‡ä»¶æœªåŒ…å«åœ¨ä»“åº“ä¸­ï¼Œå¦‚éœ€æµ‹è¯•å®Œæ•´åŠŸèƒ½ï¼Œè¯·è‡ªè¡Œå‡†å¤‡äº§å“æ‰‹å†Œç­‰æ–‡æ¡£ä¸Šä¼ è‡³ç³»ç»Ÿã€‚

## ğŸ“„ License

[MIT License](LICENSE) Â© 2025 SR88888888

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“§ è”ç³»

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æäº¤ [Issue](https://github.com/SR88888888/zhiwei-multimodal-agent/issues)ã€‚
